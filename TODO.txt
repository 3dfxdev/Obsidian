
OBLIGE TODO
===========

Current Work
------------

-  position-based monster ordering 



>>>  WEAPON.level stuff

+  level fields for games:  HERETIC  HEXEN  QUAKE2
   -  remove most start_prob

+  control modules for games:  HERETIC  QUAKE  QUAKE2
   -  level instead of rarity
   -  start_prob


REVIEW >>  build.lua : instead of resize_coord, integrate into Trans.apply stuff

FIXED?  the "apply twice" problem in prefab build code

DONE?  support m="bbox" brushes (e.g. for QUAKE2_TELEPORTER)



DOOM Shadow Algorithm:

1. assume light brush have a 2D origin point
   (probably optional, if not present the light is coming down from
    ceiling or up from floor)

2. test for intersections with nearby solid brushes.
   IF a side intersects with the light brush
   AND the light origin is on the correct side
   THEN split the light brush into 3 (at most) pieces
        (i.e. subtract the shadow area from the light brush)

3. a simpler alternative would be to change the light model
   to use simple addition of all light brushes, and merely
   create a shadow brush (at the intersection side) which cancels
   out the original light brush.



!!!!  fix the "no spot for wotsit" error
   -  make room widths have minimum of 3

+  have a monster exclusion zone around teleporters



Hallways:
  !!  monsters / items in hallways
      --> set 'belong_room' of hallway, add hall mons to that battle

  !!  fix chunk alignment in hallway connections

  +  proper height setting, use lifts when necessary


Cross-Overs:
  !!  heights are messed up?

  !!  problem where rooms get surrounded by a crossover and then
      cannot connect to anything else.

      possible solutions:
 >>   (1) require over room to already be connected to another room
      (2) teleporters
      (3) require hall to only touch two section sides (never more)
          and allow connection to non-self crossover halls
      (4) detect the problem and convert cross-over to two normal conns
          [or detect and turn crossed room into a scenic lava pit]
>>>>  (5) only make them from JUNC --> JUNC (through a reclaimed HORIZ or VERT)
          and allow (in worst case) room to join that hall.
          ALSO: support crossing 3 sections [if seeds <= 5]
          ALSO 2: corner crossing (90 degree turn)
                  can "allocate" the JUNC and create two crossover chunks

  WISH: ability to cross-over same room twice in single hall
        [even from a single junction]

  +  build the bridges / channels using prefabs

  -  sometimes make a dramatic height difference

  -  fix hallway vertical gaps


Street Mode:
DONE: limit to once per episode (higher prob in secret level)

  +  limit number of locked rooms:
     (a) if too many rooms, merge some
     (b) make some rooms be optional (storehouses or weapon)
     (c) connect some rooms via 3D bridges
  
  -  fix the sky glitch (pieces jutting inside a room)

  -  allow some buildings (especially at corners) to eat the edge

  -  better looking "streets" (via prefabs and SKINs)

  -  fix the "big junc" situation, good place for a fountain

  -  a raised outdoory room might be cool


-----------------------------------------------------------------


WISH: 3D bridges can be 3D stairs [relax area touching rule]



FIX: areas may be separated by "scenic" chunks
     --> prevent that, c.f. sub-room logic in V3


Windows: MUST decide them after all heights are done



5. corner prefab -- chunk is assumed not to be passable anymore,
   can make the whole thing solid [c.f. the V3 corner seeds]
   or make a curve or diagonal -- anything a prefab can do.
   
   need to make sure that room stays traversible

6. wall prefab -- touches one (and only one) edge of room,
   could make whole thing solid, or whatever a prefab can do.

7. big middle prefab, e.g. nukage pit



>>>  Simple rooms (caves and mazes)



OTHER STUFF

!!  u1..v2 for texture coords on brushes

    x_offset is alternate term for u1  [u2 can be absent]
    y_offset is alternate term for v1 or v2  (depends on 'peg' flag)


-----------------------------------------------------------------


Goals for next WIP
==================

+  crossovers

+  proper building facades

+  windows and fences

-  sky borders in outdoor rooms

+  system for texture coordinates


-----------------------------------------------------------------


Release Goals
=============

+  working pictures

+  caves working again

+  better ceilings, some ceiling lights

+  liquid areas


-  normal doors

-  cages

-  secret niches


?  better exits

?  diagonal corners

?  void seeds

