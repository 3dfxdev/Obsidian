
OBLIGE TODO
===========

Current Work
------------

!!!  the "apply twice" problem in prefab build code

???  the '10 - dir' thing : WHY ?

!!  seems 'good_neighbor' does not work


>> stairs....


FIX: areas may be separated by "scenic" chunks
     --> prevent that, c.f. sub-room logic in V3


"blend" chunks ? 


HEIGHT ALGO
-----------

1. current room R = start
2. do room areas in R
3. spread heights to nb_room/hallway chunks via connections
4. decide hallway chunk heights connected to R
5. R = next room, goto 2

POSSIBLE PROBLEMS
-----------------

(a) Windows : are already decided?  (NO)
    MUST decide them after all heights are done

(b) Cross-overs : need room heights of intruded room to decide
                  height of the hallway, but hallway is visited first.

                  WHAT TO DO??
                  --> if hallway is first, pick a height and if that
                      height is no good, then change it afterwards
                      [need ability to change it via stairs or lifts]


!!!  get SWITCHES and SWITCHED-DOORS working again

Area merging: prefer not to merge between different "contents"
              (especially the purpose)

              slight tendency not to merge into a connection chunk
              [since the connnection will have same height on both sides]


>>> areas.lua : all room fleshing out stuff


Doorways would be a special case, perhaps mark which seeds are
needed and perform all the allocations at the very end.

>>>  give chunks these files: z_low and z_high
     (3D stuff : allow multiple chunks in the vertical range)


Chunk/Area Allocations:

1. doorways

2. importants

3. extra stuff

4. A* connections

5. big corner -- chunk is assumed not to be passable anymore,
   can make the whole thing solid [c.f. the V3 corner seeds]
   or make a curve or diagonal -- anything a prefab can do.
   
   need to make sure that room stays traversible

6. big wall -- touches one (and only one) edge of room,
   could make whole thing solid, or whatever a prefab can do.

7. big middle prefab, e.g. nukage pit

[HMMM : probably need traversibility and/or connectivity info in
        allocated chunks [should not rely on seeds, allow 3D stuff]

8. stair -- these are done last [probably], and split the remaining
            traversible seeds into two areas.  One area should be
            fairly small (e.g. svolume <= 10) and contain a known
            walk spot, the rest can be divided further with more
            stairs  [i.e. same basic m.o. as the nuked V4 code]



>>>  Simple rooms (caves and mazes)


+  create height diffs in each room from chunks


-  build all hallways AFTER all rooms
   (decide a height different first though).


-  "flush depth" for wall prefabs, encourage/force nearby walls
   to line up with it.



OTHER STUFF

!!  u1..v2 for texture coords on brushes



////////////////////////////////////////////////////////////////////



Release Goals
-------------

Games:

DOOM2 and QUAKE only


Layout:

+  wall prefabs:
       - cage
       - monster closet
       - secret closet
       - torch
       - tech lights
       - picture
       - teleporter
       # item niche
       - lift up doorway
       - lift down doorway
 
+  corner prefabs
       - normal
       - curved
       - big diagonal
       - torch in niche
       - picture

+  floor prefabs:
       - stairs
       - lift
       - L shape
       - U shape
       - bridge

+  ceiling prefabs:
       - skylight
       - tech light
       - a gothic Quake one

+  middle prefabs:
       - cage
       - pillar
       - crates
       - fountain (outdoor)
       - a couple techy ones

+  light brushes for DOOM, clipped to room:
   (a) have group of rectangles to clip to
   (b) clip light brush to each rectangle

-  small exits

