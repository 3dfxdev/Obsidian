
WORK IN PROGRESS
================


Basic Grow Algorithm
--------------------

1. start with a single "Hub" tile at a spot near center of map.
   there will be N potential "sprouts" from it, of rank 1.

2. try to connect a tile to a sprout of lowest rank
   [ TODO: support multi-sprout connections ]

3. the new tile generates new sprouts, the rank is +1 of previous tile
   for rooms, but same rank for hallway tiles.

4. sprouts from hallways TRUMP sprouts from non-hallways if rank is same
   [ generally want to add a hallway THEN immediately add a room to it ]

5. continue this process until all sprouts are used or marked unusable.

6. remove any hallways with only a single attached room.

7. if overall level is too small, begin a new hub in the largest
   unused rectangle and repeat the above building process.

   if teleporters are allowed, connect the two distinct room-sets
   using them, otherwise create a hallway to join them [ unless two
   rooms touch ]



Scenic Borders
--------------

+  where an outdoor border area touches X, need a low-sky half-seed brush
   AND LIMIT floor of whole area to be < zone.sky_h

   (a) X can be:
       - solid wall (either in normal map or bordery parts, e.g. zone wall)
       - window
       - a porch
       - a roofed cage
       - a "ceiling-y" prefab

   [ we only know about the walls in FINISH_SCENIC_BORDERS ]

   (b) half-seed brush logic similar to SINKs -- ideally use same code

+  proper algorithm for heights
   (avoid same height of two neighboring areas)

   -  areas touching edge of map need floor_h >= zone's max floor

-  proper texturing (use cliff_mat at edge_of_map)

-  get WATER mode working again



Texturing
---------

SORT OUT : where 'facade_mat' is stored, how is accessed
  - basically, each indoor room (cave or building) has a facade_mat
    (defaulting to ZONE.building_facade or ZONE.cave_mat)

  DONE: for outdoor<-->outdoor, use the fence texture (ZONE.fence_mat)

  ??? for void, use area 'kind'

+  textures for outdoor floors
   [ Q/ still differentiate between "courtyard" and "natural" ? ]

+  hallways

-  texturing on door prefabs (for HELL, URBAN themes)



Closets
-------

+  really want to add them _AFTER_ large traps/cages have been
   added (and after outdoor borders too)




Sinks
-----

+  decide them fairly early, e.g. Room_add_sinks() -- or in layout code
   
-  add "light" to ceilings with a light texture

-  detect the "whole seed" part early (easy: all corners are inner points)
   and [for floors only] give the seed a new floor_h/floor_mat, and honor
   that floor_h when adding importants or decorative prefabs.

-  monsters: should not straddle the line between normal floor and sink
   [ draw that line in spot code ] and ideally would have correct 'Z'

-  probably should mark seeds (or whatever) so know where can place
   decorative prefabs.



Porches :
+  one per room

+  fix missing posts (where touch edge of map)

+  floor MUST be >= nearby floors (ignoring void / walled junctions)
   [ do it via floor-heights algorithm)

-  experiment with railings instead of posts (want #conns >= 2)

-  indoors or dark outdoors : light fittings



