
WORK IN PROGRESS
================

I18n : do the control modules


TITLE GENERATOR

-  support outlines
   IDEA : instead of thickness == 2, just repeat a color

+  proper style system....

-  support offseting of the pen (in Lua code)
   -  main ones are centered and top-right (as now)

-  specify outline as a DW/DH/DX/DY (plus colors etc...)



NEW LIGHTING:

-  set ambient lighting for each area:

     AMBIENT_LIGHT = A.lighting

-  for wall prefabs and closets in outdoor rooms, ones facing a
   certain direction should use "shadow" light value as ambient

-  for joiners and doors/windows : pick a value roughly between
   the two sides.  E.g. if diff == 32, use lowest + 16
   When diff == 16, use the ENTRY side.



SINKS:

+  get them working again



CEILINGS:

-  better logic for heights

   e.g. group areas into 'floor_group' -- same floor but different
   ceiling stuff (SKY vs LIGHTS vs PLAIN) and different lighting
   but same wall decoration
   


WALLS:

+  get the decorative walls working nicely
   [ pick one per area or floor_group ]

   -  support GROUP objects in 'GROUPS' table

   -  the name is always: kind .. "_" .. groupname

   -  support "env", "theme" (etc??) fields

   -  if nothing found, fall back to non-group lookup



TRAPS:

+  monster closets which open in PREVIOUS (back-track) room
   [ visit rooms with goals in them _before_ other rooms ]

+  for each trappable item/goal in a room [ upto max of 2 ]
   decide whether to create a closet trap (using a nearby unused closets)
   or a teleport trap

+  number of traps depends heavily on ROOM.pressure

-  number of traps affected by LEV.game_along

+  get teleport traps working again
   do monster depots differently, make "shared" sector based on
   an entry area of second room in the level



STAIRS:

+  choose prefabs earlier, probably during floor/ceil heights

-  support two stairs in a rule (to same area)

-  a large curved stair?



JOINERS:

!!  choose all DOOR and JOINER prefabs earlier than now.
    e.g. during floor/ceil heights or earlier

    then for switched ones, use the "action" in the Lua definition
    as the skin.special for the SWITCH prefab

+  support joiners with a height difference



TELEPORTERS:

-  check exclusion zone around a PAD works

+  exclusion zone in front of a closet



SHAPE GRAMMARS:

+  allow TWO conns into a new room (become F1/F2 in CONN object)

+  prune / re-use rooms which remain small, and hallways which
   never end up anywhere else

   [ do this BEFORE converting prelim conns into real conns ]
   
   Q/ what about joiners??
   A/ joiner becomes a closet, room becomes void

+  symmetrical rooms
   -  find straddling floor chunks in a pre-pass
      [ esp. even width for "wide" sym, odd width if not wide ]

   -  a way to score "straddling" patterns higher
      [ they are a very good place for some stuff, e.g. exits ]
      [[ only first usage of SPROUT/DECOR needs to score higher ]]



SEMANTICS of ROTATING PREFABS
-----------------------------

1. "point" prefabs are always a square, and will be rotated by a
   multiple of 90 degrees to face a certain direction

   Examples: start pad, teleport pad, exit switch, simple switch,
             crate, pillar, computer.


2. "seeds" prefabs can be square or rectangular.
   
   (a) if they have a shape, then the from_dir determines the
       vertical axis and not other rotations are possible.

       Examples: closets (often U shape)
                 stairs  (often I shape)
                 joiners (often I shape)

       [ some shapes require TWO directions ]

       [ stairs can be rotated 180 degrees to go down instead of up ]

       
   (b) no shape, rotatable

       Example:  lava pit (floor prefab)
                 sky light (ceiling prefab)


Rule: if we have a REQUIRED direction, rotation NOT allowed


